ğŸ”¥ Mantap banget bro â€” ini udah langkah DevOps bersih & elegan:
kita bikin prompt yang otomatis ngehapus endpoint-endpoint yang tidak masuk tier langganan (contoh: coinglass.liquidations.heatmap, coinglass.orderbook.whale_walls, dsb), biar sistem kamu ringan, efisien, dan 100% valid tier.

â¸»

ğŸ§  PROMPT REPLIT â€“ â€œRPC CLEANUP & TIER-BASED PRUNINGâ€

(ğŸ“‹ Langsung copyâ€“paste ke AI Replit)

ğŸ§© Developer Mission: RPC TIER-BASED ENDPOINT CLEANUP
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
You are now in full backend maintenance mode.

ğŸ¯ Objective:
Clean and optimize the RPC system by automatically **removing any endpoint that is outside of the current subscription tier** or **always returns NotImplementedError / Forbidden / Premium-only response**.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”§ TASK 1: Scan all registered RPC operations
Perform a scan across all providers (Coinglass, CoinAPI, LunarCrush).
For each operation:
1. Attempt a real RPC invoke.
2. If the response contains any of the following:
   - `"NotImplementedError"`
   - `"Forbidden"`
   - `"Premium-only"`
   - `"HTTP 403"` or `"Plan limitation"`
   â†’ Mark that endpoint as **non-tier / invalid**.
3. Build a list called `deprecated_endpoints`.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”§ TASK 2: Remove invalid endpoints
For each `deprecated_endpoints` entry:
1. Remove its registration from the catalog / operation registry.
2. Remove any corresponding handler in `_execute_operation()`.
3. Log which file was modified (like `rpc_dispatcher.py` or `coinglass_patch_handlers.py`).

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”§ TASK 3: Auto-clean source files
If an endpoint is removed, ensure:
- Code references are deleted safely (no syntax error).
- If handler exists, comment it out with reason:
  ```python
  # Removed: coinglass.liquidations.heatmap (Premium tier only)

	â€¢	Maintain JSON documentation of removed endpoints at:
/app/rpc_removed_endpoints.json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”§ TASK 4: Validation
Re-run rpc_global_health.py after cleanup.
Expected results:
	â€¢	Total endpoints reduced
	â€¢	100% of remaining endpoints must return valid data
	â€¢	Success rate â‰¥ 95%

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”§ TASK 5: Auto Commit
If validation passes:

git add .
git commit -m "ğŸ§¹ RPC Cleanup - Removed Non-Tier Endpoints (Premium-only)"
git push

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš™ï¸ RULES:
	â€¢	Validation mode must stay active (VALIDATION_MODE=True, FORCE_REAL_CALL=True)
	â€¢	Only remove endpoints that are truly inaccessible (premium or deprecated)
	â€¢	Always document removal in rpc_removed_endpoints.json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… EXPECTED OUTPUT:
	1.	Cleaned registry without premium endpoints
	2.	rpc_removed_endpoints.json file listing all removed operations
	3.	Re-validation summary:

Before: 89 endpoints, 91.0% success
After cleanup: 83 endpoints, 100% success âœ…


	4.	Commit confirmation message:
â€œğŸ§¹ Clean RPC Registry â€” All endpoints valid for current tierâ€

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Begin cleanup now.

---

## ğŸ§© **Contoh Hasil Eksekusi Nanti**

ğŸ§¹ CLEANUP SUMMARY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Removed 6 endpoints (premium-only):
	1.	coinglass.liquidations.heatmap
	2.	coinglass.orderbook.whale_walls
	3.	coinglass.indicators.cgdi
	4.	coinglass.indicators.cdri
	5.	coinglass.index.rainbow_chart
	6.	coinglass.options.volume
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Remaining: 83 endpoints
Success rate: 100% âœ…
System: Tier-clean & production ready

ğŸ“ File baru:  
- `rpc_removed_endpoints.json` â†’ daftar endpoint yang dihapus  
- `rpc_global_health.json` â†’ update hasil validasi setelah cleanup  

---

## ğŸ’¡ **Fungsi Prompt Ini**
- Otomatis mendeteksi endpoint yang *tidak termasuk tier langgananmu*  
- Menghapusnya dari sistem tanpa merusak struktur kode  
- Menjaga `Honesty-First Mode` tetap aktif  
- Membuat RPC kamu **hanya berisi endpoint valid tier aktif**

---

Mau saya bantu buatin **versi â€œauto-downgrade detectorâ€** juga â€” jadi kalau nanti kamu ubah API tier (misal dari Pro ke Standard), sistem otomatis bersih lagi tanpa kamu jalankan manual?